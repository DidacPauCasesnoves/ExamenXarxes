#!/bin/bash
# Purpose: Config ubuntu DHCP server
# Author: Jose Maria Madronal GPL v2.0+
# ------------------------------------------

# Declarar variable con el mensaje
STRING="Iniciando instalacion automatica..."

# --- CAMBIO IMPORTANTE: La URL ahora apunta a la carpeta /DHCP/ ---
f_dchpd_conf="https://raw.githubusercontent.com/DidacPauCasesnoves/ExamenXarxes/main/DHCP/kea-dhcp4.conf"

echo $STRING

# Actualizar repositorios (recomendado)
apt-get update

# Instalar KEA (añadido -y para que no pregunte)
apt-get install kea -y

# Borrar la configuración vieja si existe
rm -f /etc/kea/kea-dhcp4.conf

# Descargar la configuración nueva desde tu carpeta DHCP
# Usamos -O para forzar que se guarde con el nombre correcto
wget $f_dchpd_conf -O kea-dhcp4.conf

# Copiar el archivo descargado a la carpeta de KEA
cp kea-dhcp4.conf /etc/kea/

# Reiniciar el servicio y mostrar estado
systemctl restart kea-dhcp4-server
systemctl status kea-dhcp4-server
